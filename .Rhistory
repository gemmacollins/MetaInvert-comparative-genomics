facet_wrap(~countgroup)+
scale_color_gradient(low=get_pal("Takahe")[1], high = get_pal("Takahe")[2])+
ggtitle("bag2_11-03-2021")
## Subset by taxonomic group
ggplot(bag2_selection) +
geom_point(aes(x=reads_total_n, y=N50, col=busco_perc_M), size = 2)+
scale_x_log10()+
scale_y_log10()+
# scale_x_log10(breaks=,,1000000)+
# scale_y_log10(breaks=,,1000)+
facet_wrap(~countgroup)+
scale_color_gradient(low=get_pal("Takahe")[2], high = get_pal("Takahe")[1])+
ggtitle("bag2_11-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=log(total_length), y=busco_perc_C, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
#filter(n_contigs > 100) %>%
filter(total_length > 100000) %>%
filter(reads_total_n > 1000000)%>%
#filter(n_contigs > 1000)%>%
#filter(N50 > 1000)%>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
ggplot(bag2_selection)+
geom_point(aes(x=log(total_length), y=busco_perc_C, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
#filter(n_contigs > 100) %>%
filter(total_length > 150000) %>%
filter(reads_total_n > 1000000)%>%
#filter(n_contigs > 1000)%>%
#filter(N50 > 1000)%>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
ggplot(bag2_selection)+
geom_point(aes(x=log(total_length), y=busco_perc_C, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=log(total_length), y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=(total_length), y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=(total_length), y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
# scale_x_log10()+
# scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=total_length, y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
# scale_x_log10()+
# scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=reads_total_n, y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
# scale_x_log10()+
# scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=reads_total_n, y=n_contigs, colour = phylum), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=log(N50), y=busco_perc_C, colour = countgroup), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
scale_x_log10()+
scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
ggplot(bag2_selection)+
geom_point(aes(x=log(N50), y=busco_perc_C, colour = countgroup), size = 2)+
#geom_point(aes(x=log(N50), y=Busco_C, col=countgroup), size = 2)+
#scale_color_gradient2(high=colourmanu[2], mid = colourmanu[1])+
# scale_x_log10()+
# scale_y_log10()+
#scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3))+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
#filter(n_contigs > 100) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
filter(N50 > 1000) %>%
#filter(N50 > 1000)%>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Subset by taxonomic group
ggplot(bag2_selection) +
geom_point(aes(x=reads_total_n, y=N50, col=busco_perc_M), size = 2)+
scale_x_log10()+
scale_y_log10()+
# scale_x_log10(breaks=,,1000000)+
# scale_y_log10(breaks=,,1000)+
facet_wrap(~countgroup)+
scale_color_gradient(low=get_pal("Takahe")[2], high = get_pal("Takahe")[1])+
ggtitle("bag2_11-03-2021")
sum(is.na(bag2_selection))
names(which(colSums(is.na(bag2_selection)) > 0))
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
#filter(n_contigs > 100) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
filter(N50 > 1000) %>%
#filter(N50 > 1000)%>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
busco_perc_CF <- rowSums(bag2_selection[, c("busco_perc_C","busco_perc_F")]) # sum Busco_C + Busco_F
bag2_selection <- cbind(bag2_selection, busco_perc_CF) # add the Busco_CF column
# PCA analyses ####
## 1 Prepare a numerical matrix (pca_mx) with no NAs
bag2_selection %>%
select(phylum, countgroup, reads_total_n, perc_reads_human, n_contigs,
total_length, GC_perc, N50, busco_perc_M) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x))%>%
na.omit()->
bag2_selection_omit
bag2_selection_omit2 <- subset(bag2_selection_omit, select=-c(phylum, countgroup))
dim(bag2_selection_omit2)
pca_mx <- matrix(unlist(bag2_selection_omit2), ncol=7)
rownames(pca_mx) <- bag2_selection_omit$phylum # or change this to countgroup
#rownames(pca_mx) <- 1:235 #need unique rownames for fviz_pca below
colnames(pca_mx) <- colnames(bag2_selection_omit2)
class(pca_mx) <-"numeric"
## 2 Perform the pca analysis and plot
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
n_distinct(rownames(pca_mx))
ggbiplot(pca, obs.scale = 1, var.scale = 1, circle = F, ellipse = F, groups = rownames(pca_mx))+
scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3)) +
#theme_classic()+
ggtitle("12-03-2021_unfiltered[NAs, inf removed]")
rownames(pca_mx) <- bag2_selection_omit$countgroup # or change this to countgroup/phylum
## 2 Perform the pca analysis and plot
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
n_distinct(rownames(pca_mx))
ggbiplot(pca, obs.scale = 1, var.scale = 1, circle = F, ellipse = F, groups = rownames(pca_mx))+
scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(14)) +
#theme_classic()+
ggtitle("12-03-2021_unfiltered[NAs, inf removed]")
rownames(pca_mx) <- bag2_selection_omit$phylum # or change this to countgroup/phylum
## 2 Perform the pca analysis and plot
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
n_distinct(rownames(pca_mx))
ggbiplot(pca, obs.scale = 1, var.scale = 1, circle = F, ellipse = F, groups = rownames(pca_mx))+
scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3)) +
#theme_classic()+
ggtitle("12-03-2021_unfiltered[NAs, inf removed]")
ggbiplot(pca, obs.scale = 1, var.scale = 1, circle = F, ellipse = F, groups = rownames(pca_mx))+
scale_color_manual(values = colorRampPalette(get_pal("Takahe"))(3)) +
#theme_classic()+
ggtitle("12-03-2021_filtered")
summary(pca) #Get summary stats
str(pca)
plot(pca) #Screeplot for number of components
pca #Get standard deviations and rotation
var_explained <- pca$sdev^2/sum(pca$sdev^2)
pca$x %>%
as.data.frame %>%
ggplot(aes(x=PC1,y=PC2)) + geom_point(size=2) +
theme_bw(base_size=32) +
labs(x=paste0("PC1: ",round(var_explained[1]*100,1),"%"),
y=paste0("PC2: ",round(var_explained[2]*100,1),"%")) +
theme(legend.position="top")
library(factoextra)
fviz_contrib(pca, choice = "var", axes = 1, top = 10) # Contributions of variables to PC1
fviz_contrib(pca, choice = "var", axes = 2, top = 10) # Contributions of variables to PC2
fviz_contrib(pca, choice = "var", axes = 1:2, top = 10) # C
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=(n_contigs), fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_11-03-2021")
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=n_contigs, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
#filter(n_contigs > 100) %>%
# filter(total_length > 1000000) %>%
# filter(reads_total_n > 1000000)%>%
# filter(n_contigs > 1000)%>%
# filter(N50 > 1000) %>%
#filter(N50 > 1000)%>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=n_contigs, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=n_contigs, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
# filter(total_length > 1000000) %>%
# filter(reads_total_n > 1000000)%>%
# filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
ggtitle("bag2_12-03-2021")
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
expand_limits(x = 0, y = 0)
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
expand_limits(y = 0)
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
#scale_y_log10()+
expand_limits(y = 0)
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
#scale_y_log10()+
#expand_limits(y = 0)
ggtitle("bag2_12-03-2021")
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
#scale_y_log10()+
#expand_limits(y = 0)
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
#scale_y_log10()+
#expand_limits(y = 0)
ggtitle("bag2_12-03-2021")
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
# filter(total_length > 1000000) %>%
# filter(reads_total_n > 1000000)%>%
# filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
#scale_y_log10()+
#expand_limits(y = 0)
ggtitle("bag2_12-03-2021")
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
#expand_limits(y = 0)
ggtitle("bag2_12-03-2021")
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
expand_limits(y = 0)
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
## Box plot
ggplot(bag2_selection, aes(x=countgroup, y=total_length, fill=countgroup))+
geom_point()+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(15)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))+
scale_y_log10()+
expand_limits(y = 0)
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
filter(total_length > 1000000) %>%
filter(reads_total_n > 1000000)%>%
filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
dim(bag2_selection)
full_view %>%
filter(bag == "bag2",
!(phylum %in% c("Chordata", "CONTROL")))%>%
select(phylum, countgroup, taxon, co1_Species, co1_Order, co1_Class, co1_length,
reads_avg_seq, reads_total_n, perc_reads_human,
n_contigs, largest_contig, total_length, GC_perc, N50, N75, L50, L75,
busco_perc_C, busco_perc_S,busco_perc_D, busco_perc_F, busco_perc_M,
mapped_bases, genome_size_est) %>%
# filter(total_length > 1000000) %>%
# filter(reads_total_n > 1000000)%>%
# filter(n_contigs > 1000)%>%
#filter(N50 > 1000) %>%
mutate_if(is.numeric, function(x) ifelse(is.infinite(x), 0, x)) ->
bag2_selection
dim(bag2_selection)
