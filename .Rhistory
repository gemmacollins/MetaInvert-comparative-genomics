scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2,   scale_color_manual(values = colorRampPalette(colourmanu)(9)))+
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2,  scale_color_manual(values = colorRampPalette(colourmanu)(9))+
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2,  scale_color_manual(values = colorRampPalette(colourmanu)(9)))))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2,  scale_color_manual(values = colorRampPalette(colourmanu)(9))))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2(scale_color_manual(values = colorRampPalette(colourmanu)(9)))))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
geom_boxplot()+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
y <- log(N50)
#to do a box plot:
y <- bag2_selection_omit(log(N50))
#to do a box plot:
y <- bag2_selection_omit(log(N50))
#to do a box plot:
y <- log(bag2_selection_omit$N50))
#to do a box plot:
y <- log(bag2_selection_omit$N50)
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=y, fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
#log(N50)
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=genome_size, fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
#log(N50) genome_size
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=n_contigs, fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
#log(N50) genome_size
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=assembly_length, fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
#log(N50) genome_size
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=Busco_M, fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
#to do a box plot:
#log(N50) genome_size
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# Simple plots for each parameter ####
bag2_selection_omit %>%
pivot_longer(total_reads:Busco_M, names_to = "parameter") %>%
ggplot(mapping = aes(x = value + 1)) +
geom_histogram(bins=50) +
scale_x_log10() +
scale_y_log10() +
facet_grid(countgroup_2 ~ parameter, scales = "free_x") +
theme_bw() +
theme(axis.text.x = element_text(angle = 90),
strip.text.y = element_text(angle = 0)) ->
parameter_distribution
parameter_distribution
# par(mfrow=c(2,2))
bag2_selection_omit %>%
ggplot(mapping = aes(x = total_reads)) +
ggtitle("total_reads")+
geom_histogram(bins=100) ->
total_reads
total_reads
# Generate numerical matrix (pca_mx) ####
dim(bag2_selection_omit)
pca_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
rownames(pca_mx) <- bag2_selection_omit$countgroup_2
colnames(pca_mx) <- colnames(bag2_selection_omit)
# Generate numerical matrix num_mx) ####
dim(bag2_selection_omit)
num_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
bag2_selection_omit
pca_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
#rownames(pca_mx) <- bag2_selection_omit$countgroup_2
colnames(pca_mx) <- colnames(bag2_selection_omit)
pca_mx <- pca_mx[,-c(1:6)] # exclude columns with character entries
class(pca_mx)<-"numeric" # specify data as numeric (required for pca)
Busco_CF <- rowSums(pca_mx[, c("Busco_C","Busco_F")]) # sum Busco_C + Busco_F
pca_mx <- cbind(pca_mx, Busco_CF) # add the Busco_CF column
head(pca_mx) # visible check
rownames(pca_mx) <- bag2_selection_omit$taxon
head(pca_mx) # visible check
# PCA analyses ####
## Deal with NAs
sum(is.na(pca_mx))
# PCA analyses ####
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size < 1]
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
bag2_selection_omit
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size > 1]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size = "Inf"]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size "Inf"]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size("Inf")]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size "Inf"]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size is "Inf"]
bag2_selection_omit <- bag2_selection_omit[!bag2_selection_omit$genome_size["Inf"]]
str_replace(bag2_selection, "Inf", "NA")
str_replace(bag2_selection$genome_size, "Inf", "NA")
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
write.table(bag2_selection_omit, "bag2_selection_omit.csv", sep = ",", col.names=NA)
str_replace(bag2_selection$genome_size, "inf", "NA")
bag2_selection <- str_replace(bag2_selection$genome_size, "inf", "NA")
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
write.table(bag2_selection_omit, "bag2_selection_omit.csv", sep = ",", col.names=NA)
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
bag2_selection
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
bag2_selection <- str_replace(bag2_selection, "inf", "NA")
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
write.table(bag2_selection_omit, "bag2_selection_omit.csv", sep = ",", col.names=NA)
write.table(bag2_selection_omit, "bag2_selection_omit.csv", sep = ",", col.names=NA)
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
bag2_selection
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
bag2_selection <- sub(bag2_selection, "inf", "NA")
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
write.table(bag2_selection_omit, "bag2_selection_omit.csv", sep = ",", col.names=NA)
typeof(bag2)
f("inf", bag2)
res <- lapply(z, function(ch) grep("inf", ch))
res <- lapply(bag2_selection, function(ch) grep("inf", ch))
res
dim(bag2_selection)
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
bag2_selection
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
dim(bag2_selection_omit)
pca_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
head(pca_mx) # visible check
rownames(pca_mx) <- bag2_selection_omit$taxon
colnames(pca_mx) <- colnames(bag2_selection_omit)
head(pca_mx) # visible check
pca_mx <- pca_mx[,-c(1:6)] # exclude columns with character entries
class(pca_mx)<-"numeric" # specify data as numeric (required for pca)
Busco_CF <- rowSums(pca_mx[, c("Busco_C","Busco_F")]) # sum Busco_C + Busco_F
pca_mx <- cbind(pca_mx, Busco_CF) # add the Busco_CF column
head(pca_mx) # visible check
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
pca_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
rownames(pca_mx) <- bag2_selection_omit$taxon
colnames(pca_mx) <- colnames(bag2_selection_omit)
Busco_CF <- rowSums(pca_mx[, c("Busco_C","Busco_F")]) # sum Busco_C + Busco_F
class(pca_mx$Busco_C)<-"numeric" # specify data as numeric (required for pca)
class(pca_mx$"Busco_C")<-"numeric" # specify data as numeric (required for pca)
class("Busco_C")<-"numeric" # specify data as numeric (required for pca)
class(Busco_C)<-"numeric" # specify data as numeric (required for pca)
pca_mx
class(pca_mx[6:16])<-"numeric" # specify data as numeric (required for pca)
head(pca_mx) # visible check
sum(is.na(pca_mx))
pca_mx <- na.omit(pca_mx)
sum(is.na(pca_mx))
pca_mx
## Plot relationships between two variables
ggplot(pca_mx) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
## Remove any rows with NAs remaining
#sum(is.na(bag2_selection))
class(bag2_selection[genome_size])<-"numeric"
## Remove any rows with NAs remaining
#sum(is.na(bag2_selection))
class(bag2_selection["genome_size"])<-"numeric"
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
bag2_selection
## Remove any rows with NAs remaining
#sum(is.na(bag2_selection))
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
Taxon <- "Collembola"
ggplot(subset(bag2_selection_omit, countgroup_2==Taxon)) +
geom_point(aes(x=total_reads, y=n_contigs, col=Busco_M), size = 2)+
scale_color_gradient2(mid=colourmanu[1], high = colourmanu[4])+
ggtitle("bag2_25-02-2021")
## to do a box plot
ggplot(bag2_selection_omit, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# Simple plots for each parameter ####
bag2_selection_omit %>%
pivot_longer(total_reads:Busco_M, names_to = "parameter") %>%
ggplot(mapping = aes(x = value + 1)) +
geom_histogram(bins=50) +
scale_x_log10() +
scale_y_log10() +
facet_grid(countgroup_2 ~ parameter, scales = "free_x") +
theme_bw() +
theme(axis.text.x = element_text(angle = 90),
strip.text.y = element_text(angle = 0)) ->
parameter_distribution
parameter_distribution
# Generate numerical matrix pca_mx) ####
dim(bag2_selection_omit)
pca_mx <- matrix(unlist(bag2_selection_omit), ncol=16)
rownames(pca_mx) <- bag2_selection_omit$taxon
colnames(pca_mx) <- colnames(bag2_selection_omit)
pca_mx <- pca_mx[,-c(1:6)] # exclude columns with character entries
class(pca_mx)<-"numeric" # specify data as numeric (required for pca)
Busco_CF <- rowSums(pca_mx[, c("Busco_C","Busco_F")]) # sum Busco_C + Busco_F
pca_mx <- cbind(pca_mx, Busco_CF) # add the Busco_CF column
head(pca_mx) # visible check
# PCA analyses ####
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
selected_colours <- get_pal("Hihi")
ggbiplot(pca, obs.scale=1, var.scale = 1, circle=TRUE, ellipse = F, groups = rownames(pca_mx))+
scale_color_manual(values = colorRampPalette(selected_colours)(11)) +
ggtitle("Updated table 24-02-2021, 10 variables, NAs omitted")
save(file = "bag2_selection_omit.Rdata", bag2_selection_omit)
load("C:/Users/gec9/Documents/GitHub/MetaInvert-comparative-genomics/bag2_selection_omit.Rdata")
View(bag2_selection_omit)
# Tidy up data #####
load(file = "bag2.Rdata")
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
bag2_selection
bag2 %>%
filter(total_reads > 5e+06) ->
bag2
bag2
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
bag2_selection %>%
filter(total_reads > 5e+06) ->
bag2_selection
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
bag2_selection %>%
filter(total_reads > 2e+07) ->
bag2_selection
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
bag2_selection %>%
filter(total_reads > 2.5e+07) ->
bag2_selection
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
bag2_selection %>%
filter(!total_reads < 2.5e+07) ->
bag2_selection
bag2_selection %>%
filter(total_reads > 2.5e+07) ->
bag2_selection
bag2_selection_omit <- na.omit(bag2_selection) # some rows still have NAs: genome size = Inf
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection_omit) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
# Tidy up data #####
load(file = "bag2.Rdata")
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size)+
filter(total_reads > 2.5e+07)->
bag2_selection
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) ->
filter(total_reads > 2.5e+07)->
bag2_selection
## Select columns of interest
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
filter(total_reads > 2.5e+07)->
bag2_selection
## Remove any rows with NAs remaining
sum(is.na(bag2_selection))
## Select columns and filter out poor genomes
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
filter(total_reads > 2.5e+07)%>%
na.omit()->
bag2_selection
bag2_selection
# Tidy up data #####
load(file = "bag2.Rdata")
head(bag2)
dim(bag2)
## Select columns and filter out poor genomes
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
filter(total_reads > 2.5e+07)%>%
na.omit()->
bag2_selection
dim(bag2_selection)
## Select columns and filter out poor genomes
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
filter(total_reads > 1e+07)%>%
na.omit()->
bag2_selection
dim(bag2_selection)
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
## Select columns and filter out poor genomes
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
filter(total_reads > 1e+06)%>%
na.omit()->
bag2_selection
dim(bag2_selection)
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
## Subset bag2_selected_omit by taxonomic group
unique(bag2_selection$countgroup_2)
Taxon <- "Collembola"
ggplot(subset(bag2_selection, countgroup_2==Taxon)) +
geom_point(aes(x=total_reads, y=n_contigs, col=Busco_M), size = 2)+
scale_color_gradient2(mid=colourmanu[1], high = colourmanu[4])+
ggtitle("bag2_25-02-2021")
## Select columns and filter out poor genomes
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit()->
bag2_selection
dim(bag2_selection)
# Explore the data further with some basic visual plots ####
## Plot relationships between two variables
ggplot(bag2_selection) + geom_point(aes(x=total_reads, y=n_contigs, col=countgroup_2), size = 2)+
scale_color_manual(values = colorRampPalette(colourmanu)(9)) +
ggtitle("bag2_25-02-2021")
## to do a box plot
ggplot(bag2_selection, aes(x=countgroup_2, y=log(N50), fill=countgroup_2))+
geom_boxplot()+
scale_fill_manual(values = colorRampPalette(colourmanu)(9)) +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
# Generate numerical matrix pca_mx) ####
dim(bag2_selection)
pca_mx <- matrix(unlist(bag2_selection), ncol=16)
rownames(pca_mx) <- bag2_selection$taxon
colnames(pca_mx) <- colnames(bag2_selection)
pca_mx <- pca_mx[,-c(1:6)] # exclude columns with character entries
class(pca_mx)<-"numeric" # specify data as numeric (required for pca)
Busco_CF <- rowSums(pca_mx[, c("Busco_C","Busco_F")]) # sum Busco_C + Busco_F
pca_mx <- cbind(pca_mx, Busco_CF) # add the Busco_CF column
head(pca_mx) # visible check
# PCA analyses ####
pca <- prcomp(pca_mx, center = TRUE, scale = TRUE)
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit()%>%
inf.omit()->
bag2_selection
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit()%>%
infinite.omit()->
bag2_selection
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit()%>%
NaRV.omit()->
bag2_selection
is.infinite(bag2)
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit()%>%
!is.infinite(rowSums()) ->
bag2_selection
bag2 <- !is.infinite(rowSums(bag2_selection))
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit() %>%
filter_all(all_vars(!is.infinite(.)))->
bag2_selection
dim(bag2_selection)
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
na.omit() %>%
#filter_all(all_vars(!is.infinite(.)))->
bag2_selection
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
#filter_all(all_vars(!is.infinite(.)))
na.omit() ->
bag2_selection
dim(bag2_selection)
bag2 %>%
dplyr::select(libid, batch, phylum, countgroup_2, taxon, taxid, Busco_C, Busco_F,#read_length, total_bases,
total_reads, n_contigs, assembly_length, GC,
N50, human_reads, Busco_M, genome_size) %>%
#filter(total_reads > 1e+06)%>%
filter_all(all_vars(!is.infinite(.))) %>%
na.omit() ->
bag2_selection
dim(bag2_selection)
